<div>
    <h2>Attestation de non droit</h2>
    <button routerLink="/">Retour à l'accueil</button>

    <form [formGroup]="certificateForm" (ngSubmit)="onSubmit()">
        {{certificateForm.value | json}}
        <div class="form-group">
            <label>Nom</label>
            <input type="text" class="form-control" formControlName="familyName"
                   [class.is-invalid]="familyName.invalid && familyName.touched">
            <div *ngIf="familyName.invalid && familyName.touched">
                <small *ngIf="familyName.errors?.required" class="text-danger">Veuillez renseigner votre nom</small>
            </div>
        </div>
        <div class="form-group">
            <label>Prénom</label>
            <input type="text" class="form-control" formControlName="firstName"
                   [class.is-invalid]="firstName.invalid && firstName.touched">
            <div *ngIf="firstName.invalid && firstName.touched">
                <small *ngIf="firstName.errors?.required" class="text-danger">Veuillez renseigner votre prénom</small>
            </div>
        </div>
        <div class="form-group">
            <label>Revenus</label>
            <input type="text" class="form-control" formControlName="income"
                   [class.is-invalid]="income.invalid && income.touched">
            <div *ngIf="income.invalid && income.touched">
                <small *ngIf="income.errors?.required" class="text-danger">Veuillez renseigner vos revenus</small>
            </div>
            <small class="form-text text-muted">Soit un revenu mensuel moyen sur les 12 derniers mois,
                soit le montant des revenus sur les 12 derniers mois</small>
        </div>
        <div class="form-group">
            <label>Nombre d'enfants</label>
            <select class="form-control" formControlName="nbrChildren"
                    [class.is-invalid]="nbrChildren.invalid && nbrChildren.touched">
                <option value="{{null}}">Nombre d'enfants</option>
                <option *ngFor="let number of numbers" [ngValue]="number">{{number}}</option>
                <div *ngIf="nbrChildren.invalid && nbrChildren.touched">
                    <small *ngIf="nbrChildren.errors?.required" class="text-danger">
                        Veuillez indiquer le nombre d'enfants
                    </small>
                </div>
            </select>
        </div>
        <div *ngFor="let item of children.controls; let i = index" formArrayName="children">
            <h4>Enfant {{i + 1}}</h4>
            <div [formGroupName]="i" class="row">
                <div class="col form-group">
                    <label>Nom</label>
                    <input type="text" class="form-control" formControlName="familyName"
                           [class.is-invalid]="item.get('familyName').invalid && item.get('familyName').touched">
                    <div *ngIf="item.get('familyName').invalid && item.get('familyName').touched">
                        <small *ngIf="item.get('familyName').errors?.required" class="text-danger">
                            Veuillez indiquer le nom de famille
                        </small>
                    </div>
                </div>
                <div class="col form-group">
                    <label>Prénom</label>
                    <input type="text" class="form-control" formControlName="firstName"
                           [class.is-invalid]="item.get('firstName').invalid && item.get('firstName').touched">
                    <div *ngIf="item.get('firstName').invalid && item.get('firstName').touched">
                        <small *ngIf="item.get('firstName').errors?.required" class="text-danger">
                            Veuillez indiquer le prénom
                        </small>
                    </div>
                </div>
                <div class="col form-group">
                    <app-select-scholar-level [formGroup]="item"></app-select-scholar-level>
                </div>
            </div>
        </div>

        <button [disabled]='!certificateForm.valid' class="btn btn-primary" type="submit">Enregistrer</button>
    </form>

</div>
